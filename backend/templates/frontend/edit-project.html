{% extends 'frontend/base.html' %}

{% block title %}Edit Project - IT Management Platform{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-6 sm:py-8">
    <div class="mb-6 sm:mb-8">
        <h1 class="text-2xl sm:text-4xl font-bold text-gray-900 mb-2">Edit Project</h1>
        <p class="text-xs sm:text-base text-gray-600">Update project information and settings</p>
    </div>

    <!-- Breadcrumb -->
    <div class="mb-6">
        <nav class="flex text-xs sm:text-sm" aria-label="Breadcrumb">
            <ol class="flex items-center space-x-2">
                <li>
                    <a href="{% url 'frontend:dashboard' %}" class="text-gray-500 hover:text-gray-700">Dashboard</a>
                </li>
                <li class="flex items-center">
                    <svg class="flex-shrink-0 h-4 w-4 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"/>
                    </svg>
                    <a href="{% url 'frontend:projects' %}" class="ml-2 text-gray-500 hover:text-gray-700">Projects</a>
                </li>
                <li class="flex items-center">
                    <svg class="flex-shrink-0 h-4 w-4 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"/>
                    </svg>
                    <span class="ml-2 text-gray-900 font-medium">{{ project.name }}</span>
                </li>
            </ol>
        </nav>
    </div>

    <!-- Messages -->
    {% if messages %}
        {% for message in messages %}
        <div class="mb-6 p-3 sm:p-4 {% if message.tags == 'success' %}bg-green-50 border border-green-200 text-green-800{% elif message.tags == 'error' %}bg-red-50 border border-red-200 text-red-800{% else %}bg-blue-50 border border-blue-200 text-blue-800{% endif %} rounded-lg text-xs sm:text-sm">
            {{ message }}
        </div>
        {% endfor %}
    {% endif %}

    <!-- Edit Project Form -->
    <div class="bg-white rounded-lg shadow-md p-4 sm:p-6">
        <form method="POST" id="editProjectForm" class="space-y-4 sm:space-y-6">
            {% csrf_token %}
            
            <!-- Basic Information -->
            <div>
                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 border-b pb-2">Basic Information</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                    <div class="md:col-span-2">
                        <label for="name" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Project Name *</label>
                        <input type="text" id="name" name="name" value="{{ project.name }}" required
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        {% if errors.name %}
                        <p class="mt-1 text-xs text-red-600">{{ errors.name }}</p>
                        {% endif %}
                    </div>
                    <div class="md:col-span-2">
                        <label for="description" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Description *</label>
                        <textarea id="description" name="description" rows="3" required
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">{{ project.description }}</textarea>
                        {% if errors.description %}
                        <p class="mt-1 text-xs text-red-600">{{ errors.description }}</p>
                        {% endif %}
                    </div>
                    <div>
                        <label for="category" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Category *</label>
                        <select id="category" name="category" required
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Select Category</option>
                            {% for cat in categories %}
                            <option value="{{ cat.id }}" {% if project.category.id == cat.id %}selected{% endif %}>{{ cat.name }}</option>
                            {% endfor %}
                        </select>
                        {% if errors.category %}
                        <p class="mt-1 text-xs text-red-600">{{ errors.category }}</p>
                        {% endif %}
                    </div>
                    <div>
                        <label for="status" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Status *</label>
                        <select id="status" name="status" required
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="PLANNING" {% if project.status == 'PLANNING' %}selected{% endif %}>Planning</option>
                            <option value="ACTIVE" {% if project.status == 'ACTIVE' %}selected{% endif %}>Active</option>
                            <option value="ON_HOLD" {% if project.status == 'ON_HOLD' %}selected{% endif %}>On Hold</option>
                            <option value="COMPLETED" {% if project.status == 'COMPLETED' %}selected{% endif %}>Completed</option>
                            <option value="CANCELLED" {% if project.status == 'CANCELLED' %}selected{% endif %}>Cancelled</option>
                            <option value="ARCHIVED" {% if project.status == 'ARCHIVED' %}selected{% endif %}>Archived</option>
                        </select>
                    </div>
                    <div>
                        <label for="priority" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Priority *</label>
                        <select id="priority" name="priority" required
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="LOW" {% if project.priority == 'LOW' %}selected{% endif %}>Low</option>
                            <option value="MEDIUM" {% if project.priority == 'MEDIUM' %}selected{% endif %}>Medium</option>
                            <option value="HIGH" {% if project.priority == 'HIGH' %}selected{% endif %}>High</option>
                            <option value="URGENT" {% if project.priority == 'URGENT' %}selected{% endif %}>Urgent</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Timeline -->
            <div>
                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 border-b pb-2">Timeline</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 sm:gap-4">
                    <div>
                        <label for="start_date" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Start Date</label>
                        <input type="date" id="start_date" name="start_date" value="{{ project.start_date|date:'Y-m-d' }}"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="end_date" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">End Date</label>
                        <input type="date" id="end_date" name="end_date" value="{{ project.end_date|date:'Y-m-d' }}"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="deadline" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Deadline</label>
                        <input type="date" id="deadline" name="deadline" value="{{ project.deadline|date:'Y-m-d' }}"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>
            </div>

            <!-- Project Management -->
            <div>
                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 border-b pb-2">Project Management</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                    <div>
                        <label for="project_manager" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Project Manager *</label>
                        <select id="project_manager" name="project_manager" required
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Select Project Manager</option>
                            {% for user in available_users %}
                            <option value="{{ user.id }}" {% if project.project_manager.id == user.id %}selected{% endif %}>
                                {{ user.username }} ({{ user.first_name }} {{ user.last_name }})
                            </option>
                            {% endfor %}
                        </select>
                        {% if errors.project_manager %}
                        <p class="mt-1 text-xs text-red-600">{{ errors.project_manager }}</p>
                        {% endif %}
                    </div>
                    <div>
                        <label for="budget" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Budget</label>
                        <input type="number" id="budget" name="budget" step="0.01" value="{{ project.budget|default:'' }}"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>
            </div>

            <!-- Project Details -->
            <div>
                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 border-b pb-2">Project Details</h3>
                <div class="grid grid-cols-1 gap-3 sm:gap-4">
                    <div>
                        <label for="objectives" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Objectives</label>
                        <textarea id="objectives" name="objectives" rows="3"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">{{ project.objectives }}</textarea>
                    </div>
                    <div>
                        <label for="requirements" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Requirements</label>
                        <textarea id="requirements" name="requirements" rows="3"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">{{ project.requirements }}</textarea>
                    </div>
                    <div>
                        <label for="deliverables" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Deliverables</label>
                        <textarea id="deliverables" name="deliverables" rows="3"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">{{ project.deliverables }}</textarea>
                    </div>
                </div>
            </div>

            <!-- Risk Management -->
            <div>
                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 border-b pb-2">Risk Management</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                    <div>
                        <label for="risk_level" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Risk Level</label>
                        <select id="risk_level" name="risk_level"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="LOW" {% if project.risk_level == 'LOW' %}selected{% endif %}>Low</option>
                            <option value="MEDIUM" {% if project.risk_level == 'MEDIUM' %}selected{% endif %}>Medium</option>
                            <option value="HIGH" {% if project.risk_level == 'HIGH' %}selected{% endif %}>High</option>
                            <option value="URGENT" {% if project.risk_level == 'URGENT' %}selected{% endif %}>Urgent</option>
                        </select>
                    </div>
                    <div>
                        <label for="risk_description" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Risk Description</label>
                        <textarea id="risk_description" name="risk_description" rows="3"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">{{ project.risk_description }}</textarea>
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="flex flex-col sm:flex-row justify-end gap-3 sm:space-x-4 pt-4 border-t">
                <a href="{% url 'frontend:projects' %}" class="inline-flex justify-center px-4 py-2 text-xs sm:text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    Cancel
                </a>
                <button type="submit" class="inline-flex justify-center px-4 py-2 text-xs sm:text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    Save Changes
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

