{% extends 'frontend/base.html' %}

{% block title %}Edit Asset - IT Management Platform{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-6 sm:py-8">
    <div class="mb-6 sm:mb-8">
        <h1 class="text-2xl sm:text-4xl font-bold text-gray-900 mb-2">Edit Asset</h1>
        <p class="text-xs sm:text-base text-gray-600">Update asset information</p>
    </div>

    <!-- Breadcrumb -->
    <div class="mb-6">
        <nav class="flex text-xs sm:text-sm" aria-label="Breadcrumb">
            <ol class="flex items-center space-x-2">
                <li>
                    <a href="{% url 'frontend:dashboard' %}" class="text-gray-500 hover:text-gray-700">Dashboard</a>
                </li>
                <li class="flex items-center">
                    <svg class="flex-shrink-0 h-4 w-4 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"/>
                    </svg>
                    <a href="{% url 'frontend:assets' %}" class="ml-2 text-gray-500 hover:text-gray-700">Assets</a>
                </li>
                <li class="flex items-center">
                    <svg class="flex-shrink-0 h-4 w-4 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"/>
                    </svg>
                    <span class="ml-2 text-gray-900 font-medium">{{ asset.name }}</span>
                </li>
            </ol>
        </nav>
    </div>

<!-- Edit Asset Form -->
{% if permissions.can_update %}
<div class="bg-white rounded-lg shadow-md p-4 sm:p-6">
        <form method="POST" id="editAssetForm" class="space-y-4 sm:space-y-6">
            {% csrf_token %}
            
            <!-- Basic Information -->
            <div>
                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 border-b pb-2">Basic Information</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                    <div>
                        <label for="name" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Asset Name *</label>
                        <input type="text" id="name" name="name" value="{{ asset.name }}" required
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        {% if errors.name %}
                        <p class="mt-1 text-xs text-red-600">{{ errors.name }}</p>
                        {% endif %}
                    </div>
                    <div>
                        <label for="asset_tag" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Asset Tag *</label>
                        <input type="text" id="asset_tag" name="asset_tag" value="{{ asset.asset_tag }}" required
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        {% if errors.asset_tag %}
                        <p class="mt-1 text-xs text-red-600">{{ errors.asset_tag }}</p>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Type and Category -->
            <div>
                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 border-b pb-2">Classification</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                    <div>
                        <label for="asset_type" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Asset Type *</label>
                        <select id="asset_type" name="asset_type" required
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Select Type</option>
                            <option value="HARDWARE" {% if asset.asset_type == 'HARDWARE' %}selected{% endif %}>Hardware</option>
                            <option value="SOFTWARE" {% if asset.asset_type == 'SOFTWARE' %}selected{% endif %}>Software</option>
                            <option value="NETWORK" {% if asset.asset_type == 'NETWORK' %}selected{% endif %}>Network</option>
                            <option value="PERIPHERAL" {% if asset.asset_type == 'PERIPHERAL' %}selected{% endif %}>Peripheral</option>
                            <option value="COMPONENT" {% if asset.asset_type == 'COMPONENT' %}selected{% endif %}>Component</option>
                        </select>
                    </div>
                    <div>
                        <label for="category" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Category *</label>
                        <select id="category" name="category" required
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">Select Category</option>
                            {% for category in categories %}
                            <option value="{{ category.id }}" {% if asset.category.id == category.id %}selected{% endif %}>{{ category.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>

            <!-- Description and Status -->
            <div>
                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 border-b pb-2">Details</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                    <div class="md:col-span-2">
                        <label for="description" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Description</label>
                        <textarea id="description" name="description" rows="3"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">{{ asset.description }}</textarea>
                    </div>
                    <div>
                        <label for="status" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Status *</label>
                        <select id="status" name="status" required
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="ACTIVE" {% if asset.status == 'ACTIVE' %}selected{% endif %}>Active</option>
                            <option value="INACTIVE" {% if asset.status == 'INACTIVE' %}selected{% endif %}>Inactive</option>
                            <option value="MAINTENANCE" {% if asset.status == 'MAINTENANCE' %}selected{% endif %}>Maintenance</option>
                            <option value="RETIRED" {% if asset.status == 'RETIRED' %}selected{% endif %}>Retired</option>
                        </select>
                    </div>
                    <div>
                        <label for="location" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Location</label>
                        <input type="text" id="location" name="location" value="{{ asset.location }}"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>
            </div>

            <!-- Assignment -->
            <div>
                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 border-b pb-2">Assignment</h3>
                <div>
                    <label for="assigned_to" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Assigned To</label>
                    <select id="assigned_to" name="assigned_to"
                        class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Unassigned</option>
                        {% for user in available_users %}
                        <option value="{{ user.id }}" {% if asset.assigned_to.id == user.id %}selected{% endif %}>{{ user.username }} ({{ user.first_name }} {{ user.last_name }})</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <!-- Technical Details -->
            <div>
                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 border-b pb-2">Technical Details</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                    <div>
                        <label for="serial_number" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Serial Number</label>
                        <input type="text" id="serial_number" name="serial_number" value="{{ asset.serial_number }}"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="model" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Model</label>
                        <input type="text" id="model" name="model" value="{{ asset.model }}"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="manufacturer" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Manufacturer</label>
                        <input type="text" id="manufacturer" name="manufacturer" value="{{ asset.manufacturer }}"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="version" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Version</label>
                        <input type="text" id="version" name="version" value="{{ asset.version }}"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>
            </div>

            <!-- Purchase Information -->
            <div>
                <h3 class="text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4 border-b pb-2">Purchase Information</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 sm:gap-4">
                    <div>
                        <label for="purchase_date" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Purchase Date</label>
                        <input type="date" id="purchase_date" name="purchase_date" value="{{ asset.purchase_date|date:'Y-m-d' }}"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="purchase_cost" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Purchase Cost</label>
                        <input type="number" id="purchase_cost" name="purchase_cost" step="0.01" value="{{ asset.purchase_cost }}"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="warranty_expiry" class="block text-xs sm:text-sm font-medium text-gray-700 mb-1">Warranty Expiry</label>
                        <input type="date" id="warranty_expiry" name="warranty_expiry" value="{{ asset.warranty_expiry|date:'Y-m-d' }}"
                            class="w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="flex flex-col sm:flex-row justify-end gap-3 sm:space-x-4 pt-4 border-t">
                <a href="{% url 'frontend:assets' %}" class="inline-flex justify-center px-4 py-2 text-xs sm:text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    Cancel
                </a>
                <button type="submit" class="inline-flex justify-center px-4 py-2 text-xs sm:text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    Save Changes
                </button>
            </div>
        </form>
    </div>
{% else %}
<div class="bg-white rounded-lg shadow-md p-6 text-center">
    <h3 class="text-lg font-semibold text-gray-900 mb-2">Permission Denied</h3>
    <p class="text-sm text-gray-600 mb-4">
        You do not have permission to edit this asset.
    </p>
    <a href="{% url 'frontend:assets' %}"
       class="inline-flex justify-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700">
        Back to Assets
    </a>
</div>
{% endif %}
{% endblock %}

